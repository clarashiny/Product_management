<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Product CRUD App</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
    background: #f2f2f2;
    padding: 20px;
    font-family: Arial;
}

.container {
    max-width: 1200px;
}

form {
    background: white;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
}

#productList {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* 4 boxes */
    gap: 20px;
}

.product-card {
    background: white;
    padding: 15px;
    border-radius: 10px;
    text-align: center;
}

.product-card img {
    width: 120px;
    height: 150px;
    object-fit: contain;
}
</style>
</head>

<body>

<div class="container">
    <h2 class="text-center">Product Management CRUD App</h2>

    <!-- PRODUCT FORM -->
    <form id="productForm">
        <input type="hidden" id="productId">

        <input type="text" id="title" class="form-control mb-2" placeholder="Product title" required>
        <input type="text" id="price" class="form-control mb-2" placeholder="Price" required>
        <textarea id="description" class="form-control mb-2" placeholder="Description"></textarea>
        <input type="text" id="image" class="form-control mb-2" placeholder="Image URL">

        <button type="submit" class="btn btn-success">Save Product</button>
    </form>

    <!-- SEARCH -->
    <input type="text" id="searchInput" class="form-control mb-3"
           placeholder="Search product by title"
           onkeyup="searchProduct()">

    <!-- PRODUCT LIST -->
    <div id="productList"></div>
</div>

<script>
var apiUrl = "https://fakestoreapi.com/products";
var productListData = [];

// READ - Fetch all products
function fetchProducts() {
    fetch(apiUrl)
    .then(function(response) {
        return response.json();
    })
    .then(function(data) {
        productListData = data;
        showProducts(productListData);
    });
}

// DISPLAY products
function showProducts(data) {
    var productList = document.getElementById("productList");
    productList.innerHTML = "";

    for (var i = 0; i < data.length; i++) {
        productList.innerHTML +=
            '<div class="product-card">' +
                '<img src="' + data[i].image + '">' +
                '<h6>' + data[i].title + '</h6>' +
                '<p>â‚¹ ' + data[i].price + '</p>' +
                '<button class="btn btn-warning btn-sm" onclick="editProduct(' + data[i].id + ')">Edit</button> ' +
                '<button class="btn btn-primary btn-sm" onclick="deleteProduct(' + data[i].id + ')">Delete</button>' +
            '</div>';
    }
}

// SEARCH product


function searchProduct() {
    var text = document.getElementById("searchInput").value.toLowerCase();
    var result = [];

    for (var i = 0; i < productListData.length; i++) {
        if (productListData[i].title.toLowerCase().includes(text)) {
            result.push(productListData[i]);
        }
    }

    showProducts(result);
}


// READ single product (for edit)
function editProduct(id) {
    fetch(apiUrl + "/" + id)
    .then(function(res) {
        return res.json();
    })
    .then(function(item) {
        document.getElementById("productId").value = item.id;
        document.getElementById("title").value = item.title;
        document.getElementById("price").value = item.price;
        document.getElementById("description").value = item.description;
        document.getElementById("image").value = item.image;
    });
}

// CREATE or UPDATE product
document.getElementById("productForm").addEventListener("submit", function(e) {
    e.preventDefault();

    var id = document.getElementById("productId").value;

    var productData = {
        title: document.getElementById("title").value,
        price: document.getElementById("price").value,
        description: document.getElementById("description").value,
        image: document.getElementById("image").value
    };

    if (id) {
        // UPDATE
        fetch(apiUrl + "/" + id, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(productData)
        }).then(function() {
            alert("Product updated");
            fetchProducts();
        });
    } else {
        // CREATE
        fetch(apiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(productData)
        }).then(function() {
            alert("Product added");
            fetchProducts();
        });
    }

    e.target.reset();
});

// DELETE product
function deleteProduct(id) {
    if (confirm("Are you sure to delete this product?")) {
        fetch(apiUrl + "/" + id, { method: "DELETE" })
        .then(function() {
            alert("Product deleted");
            fetchProducts();
        });
    }
}

// Initial load
fetchProducts();
</script>

</body>
</html>

